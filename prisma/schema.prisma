generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Language {
  id                   Int                   @id @default(autoincrement())
  name                 String                @db.VarChar(500)
  code                 String                @unique @db.VarChar(10)
  userTranslations     UserTranslation[]
  categoryTranslations CategoryTranslation[]

  createdById Int?
  createdBy   User? @relation("LanguageCreatedBy", fields: [createdById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  updatedById Int?
  updatedBy   User? @relation("LanguageUpdatedBy", fields: [updatedById], references: [id], onDelete: SetNull, onUpdate: NoAction)

  deletedAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model User {
  id                 Int            @id @default(autoincrement())
  email              String         @unique
  username           String?        @db.VarChar(500)
  fullname           String         @db.VarChar(500)
  password           String         @db.VarChar(500)
  phoneNumber        String         @db.VarChar(50)
  avatar             String?        @db.VarChar(1000)
  dateOfBirth        DateTime?
  lockExpirationDate DateTime?
  lastViolation      UserViolation? @relation("LastViolation", fields: [lastViolationId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  lastViolationId    Int?
  totpSecret         String?        @unique @db.VarChar(1000)
  status             UserStatus     @default(INACTIVE)

  roleId Int
  role   Role @relation(fields: [roleId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  refreshTokens               RefreshToken[]
  createdPermissions          Permission[]              @relation("PermissionCreatedBy")
  updatedPermissions          Permission[]              @relation("PermissionUpdatedBy")
  createdRoles                Role[]                    @relation("RoleCreatedBy")
  updatedRoles                Role[]                    @relation("RoleUpdatedBy")
  createdCategories           Category[]                @relation("CategoryCreatedBy")
  updatedCategories           Category[]                @relation("CategoryUpdatedBy")
  createdLanguages            Language[]                @relation("LanguageCreatedBy")
  updatedLanguages            Language[]                @relation("LanguageUpdatedBy")
  createdCategoryTranslations CategoryTranslation[]     @relation("CategoryTranslationCreatedBy")
  updatedCategoryTranslations CategoryTranslation[]     @relation("CategoryTranslationUpdatedBy")
  createdUserTranslations     UserTranslation[]         @relation("UserTranslationCreatedBy")
  updatedUserTranslations     UserTranslation[]         @relation("UserTranslationUpdatedBy")
  userTranslations            UserTranslation[]         @relation("User")
  violations                  UserViolation[]           @relation("UserViolations")
  createViolationsByUser      UserViolation[]           @relation("CreateViolationsByUser")
  updateViolationsByUser      UserViolation[]           @relation("UpdateViolationsByUser")
  createCourseByUser          Course[]                  @relation("createCourseByUser")
  updateCourseByUser          Course[]                  @relation("updateCourseByUser")
  createModuleByUser          Module[]                  @relation("createModuleByUser")
  updateModuleByUser          Module[]                  @relation("updateModuleByUser")
  createLessonByUser          Lesson[]                  @relation("createLessonByUser")
  updateLessonByUser          Lesson[]                  @relation("updateLessonByUser")
  lessonCompleteByUser        LessonCompletion[]        @relation("lessonCompleteByUser")
  createLessonCompleteByUser  LessonCompletion[]        @relation("createLessonCompleteByUser")
  updateLessonCompleteByUser  LessonCompletion[]        @relation("updateLessonCompleteByUser")
  userCertificate             Certificate[]             @relation("userCertificate")
  createCertificateByUser     Certificate[]             @relation("createCertificateByUser")
  updateCertificateByUser     Certificate[]             @relation("updateCertificateByUser")
  userEnrollment              Enrollment[]              @relation("userEnrollment")
  createEnrollmentByUser      Enrollment[]              @relation("createEnrollmentByUser")
  updateEnrollmentByUser      Enrollment[]              @relation("updateEnrollmentByUser")
  createBlogByUser            Blog[]                    @relation("createBlogByUser")
  updateBlogByUser            Blog[]                    @relation("updateBlogByUser")
  createBlogTopicByUser       BlogTopic[]               @relation("createBlogTopicByUser")
  updateBlogTopicByUser       BlogTopic[]               @relation("updateBlogTopicByUser")
  userBlogBookmark            BlogBookmark[]            @relation("userBlogBookmark")
  createBlogBookmarkByUser    BlogBookmark[]            @relation("createBlogBookmarkByUser")
  updateBlogBookmarkByUser    BlogBookmark[]            @relation("updateBlogBookmarkByUser")
  userLearningPath            LearningPath[]            @relation("userLearningPath")
  createLearningPathByUser    LearningPath[]            @relation("createLearningPathByUser")
  updateLearningPathByUser    LearningPath[]            @relation("updateLearningPathByUser")
  userLessonBookmark          LessonBookmark[]          @relation("userLessonBookmark")
  createLessonBookmarkByUser  LessonBookmark[]          @relation("createLessonBookmarkByUser")
  updateLessonBookmarkByUser  LessonBookmark[]          @relation("updateLessonBookmarkByUser")
  userWishlist                Wishlist[]                @relation("userWishlist")
  createWishlistByUser        Wishlist[]                @relation("createWishlistByUser")
  updateWishlistByUser        Wishlist[]                @relation("updateWishlistByUser")
  userCart                    Cart[]                    @relation("userCart")
  createCartByUser            Cart[]                    @relation("createCartByUser")
  updateCartByUser            Cart[]                    @relation("updateCartByUser")
  userOrder                   Order[]                   @relation("userOrder")
  createOrderByUser           Order[]                   @relation("createOrderByUser")
  updateOrderByUser           Order[]                   @relation("updateOrderByUser")
  createOrderItemByUser       OrderItem[]               @relation("createOrderItemByUser")
  updateOrderItemByUser       OrderItem[]               @relation("updateOrderItemByUser")
  userComment                 Comment[]                 @relation("userComment")
  createCommentByUser         Comment[]                 @relation("createCommentByUser")
  updateCommentByUser         Comment[]                 @relation("updateCommentByUser")
  userReview                  Review[]                  @relation("userReview")
  createReviewByUser          Review[]                  @relation("createReviewByUser")
  updateReviewByUser          Review[]                  @relation("updateReviewByUser")
  userFollower                Follower[]                @relation("userFollower")
  createFollowerByUser        Follower[]                @relation("createFollowerByUser")
  updateFollowerByUser        Follower[]                @relation("updateFollowerByUser")
  userTeacher                 Teacher[]                 @relation("userTeacher")
  createTeacherByUser         Teacher[]                 @relation("createTeacherByUser")
  updateTeacherByUser         Teacher[]                 @relation("updateTeacherByUser")
  createCouponByUser          Coupon[]                  @relation("createCouponByUser")
  updateCouponByUser          Coupon[]                  @relation("updateCouponByUser")
  userCouponUsage             CouponUsage[]             @relation("userCouponUsage")
  createCouponUsageByUser     CouponUsage[]             @relation("createCouponUsageByUser")
  updateCouponUsageByUser     CouponUsage[]             @relation("updateCouponUsageByUser")
  createSystemDiscountByUser  SystemDiscount[]          @relation("createSystemDiscountByUser")
  updateSystemDiscountByUser  SystemDiscount[]          @relation("updateSystemDiscountByUser")
  createHashtagByUser         Hashtag[]                 @relation("createHashtagByUser")
  updateHashtagByUser         Hashtag[]                 @relation("updateHashtagByUser")
  userBlogLike                BlogLike[]                @relation("userBlogLike")
  createBlogLikeByUser        BlogLike[]                @relation("createBlogLikeByUser")
  updateBlogLikeByUser        BlogLike[]                @relation("updateBlogLikeByUser")
  userBlogComment             BlogComment[]             @relation("userBlogComment")
  createBlogCommentByUser     BlogComment[]             @relation("createBlogCommentByUser")
  updateBlogCommentByUser     BlogComment[]             @relation("updateBlogCommentByUser")
  userCommentReaction         CommentReaction[]         @relation("userCommentReaction")
  createCommentReactionByUser CommentReaction[]         @relation("createCommentReactionByUser")
  updateCommentReactionByUser CommentReaction[]         @relation("updateCommentReactionByUser")
  createQuizzByUser           Quizz[]                   @relation("createQuizzByUser")
  updateQuizzByUser           Quizz[]                   @relation("updateQuizzByUser")
  createQuizQuestionByUser    QuizQuestion[]            @relation("createQuizQuestionByUser")
  updateQuizQuestionByUser    QuizQuestion[]            @relation("updateQuizQuestionByUser")
  createQuizAnswerOptByUser   QuizAnswerOption[]        @relation("createQuizAnswerOptionByUser")
  updateQuizAnswerOptByUser   QuizAnswerOption[]        @relation("updateQuizAnswerOptionByUser")
  userQuizAttempt             QuizAttempt[]             @relation("userQuizAttempt")
  createQuizAttemptByUser     QuizAttempt[]             @relation("createQuizAttemptByUser")
  updateQuizAttemptByUser     QuizAttempt[]             @relation("updateQuizAttemptByUser")
  createQuizUserAnswerByUser  QuizUserAnswer[]          @relation("createQuizUserAnswerByUser")
  updateQuizUserAnswerByUser  QuizUserAnswer[]          @relation("updateQuizUserAnswerByUser")
  userFeedback                Feedback[]                @relation("userFeedback")
  createFeedbackByUser        Feedback[]                @relation("createFeedbackByUser")
  updateFeedbackByUser        Feedback[]                @relation("updateFeedbackByUser")
  createBannerByUser          Banner[]                  @relation("createBannerByUser")
  updateBannerByUser          Banner[]                  @relation("updateBannerByUser")
  userPurchaseHistory         PurchaseHistory[]         @relation("userPurchaseHistory")
  userSubscription            Subscription[]            @relation("userSubscription")
  userPurchaseAnalytics       PurchaseAnalytics[]       @relation("userPurchaseAnalytics")
  userUserPaymentMethod       UserPaymentMethod[]       @relation("userUserPaymentMethod")
  userRequestedBy             RefundRequest[]           @relation("RequestedBy")
  userApprovedBy              RefundRequest[]           @relation("ApprovedBy")
  createConversationByUser    Conversation[]            @relation("createConversationByUser")
  updateConversationByUser    Conversation[]            @relation("updateConversationByUser")
  userConversationParticipant ConversationParticipant[] @relation("userConversationParticipant")
  joinRequestsSent            ConversationJoinRequest[] @relation("JoinRequestRequester")
  joinRequestsReceived        ConversationJoinRequest[] @relation("JoinRequestInvitedUser")
  senderMessage               Message[]                 @relation("senderMessage")
  deleteMessagenByUser        Message[]                 @relation("deleteMessagenByUser")
  messageReadByUser           MessageRead[]             @relation("messageReadByUser")
  messageReactionByUser       MessageReaction[]         @relation("messageReactionByUser")
  userNotification            Notification[]            @relation("userNotification")
  userUploadFile              FileUpload[]              @relation("userUploadFile")
  devices                     Device[]

  createdById  Int?
  createdBy    User?  @relation("CreatorUsers", fields: [createdById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  createdUsers User[] @relation("CreatorUsers")

  updatedById  Int?
  updatedBy    User?  @relation("UpdatorUsers", fields: [updatedById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  updatedUsers User[] @relation("UpdatorUsers")

  qaThreadsAsAuthor     QaThread[]     @relation("QaThreadAuthor")
  qaThreadsAsInstructor QaThread[]     @relation("QaThreadInstructor")
  qaPosts               QaPost[]       @relation("QaPostAuthor")
  qaReactions           QaReaction[]   @relation("QaReactionByUser")
  qaThreadReads         QaThreadRead[]

  deletedAt  DateTime?
  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt
  MessagePin MessagePin[]
}

model UserViolation {
  id               Int           @id @default(autoincrement())
  userId           Int
  user             User          @relation("UserViolations", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  reason           String
  violationType    ViolationType
  actionTaken      ActionTaken
  lockDurationDays Int?
  isDelete         Boolean       @default(false)
  createdAt        DateTime      @default(now())
  createdById      Int?
  createdBy        User?         @relation("CreateViolationsByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedAt        DateTime      @updatedAt
  updatedBy        User?         @relation("UpdateViolationsByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById      Int?
  deletedAt        DateTime?
  lastViolationFor User[]        @relation("LastViolation")

  @@index([createdAt])
  @@index([userId])
}

model UserTranslation {
  id          Int      @id @default(autoincrement())
  userId      Int
  user        User     @relation("User", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  languageId  Int
  language    Language @relation(fields: [languageId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  address     String?  @db.VarChar(500)
  description String?

  createdById Int?
  createdBy   User? @relation("UserTranslationCreatedBy", fields: [createdById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  updatedById Int?
  updatedBy   User? @relation("UserTranslationUpdatedBy", fields: [updatedById], references: [id], onDelete: SetNull, onUpdate: NoAction)

  deletedAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model VerificationCode {
  id    Int                  @id @default(autoincrement())
  email String               @unique @db.VarChar(500)
  code  String               @db.VarChar(50)
  type  VerificationCodeType

  expiresAt DateTime
  createdAt DateTime @default(now())

  @@unique([email, code, type])
  @@index([email, code, type])
  @@index([expiresAt])
}

model Device {
  id            Int            @id @default(autoincrement())
  userId        Int
  user          User           @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userAgent     String
  ip            String
  lastActive    DateTime       @updatedAt // Thay updatedAt bằng lastActive cho ý nghĩa rõ hơn
  createdAt     DateTime       @default(now())
  isActive      Boolean        @default(true) // Trạng thái thiết bị (đang login hay đã logout)
  refreshTokens RefreshToken[] // Liên kết 1-n với RefreshToken
}

model RefreshToken {
  token     String   @unique @db.VarChar(1000)
  userId    Int
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  deviceId  Int // Foreign key tới Device
  device    Device   @relation(fields: [deviceId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  expiresAt DateTime
  createdAt DateTime @default(now())

  @@index([expiresAt])
}

model Permission {
  id          Int        @id @default(autoincrement())
  name        String     @db.VarChar(500)
  description String
  path        String     @db.VarChar(1000)
  method      HTTPMethod
  roles       Role[]

  createdById Int?
  createdBy   User? @relation("PermissionCreatedBy", fields: [createdById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  updatedById Int?
  updatedBy   User? @relation("PermissionUpdatedBy", fields: [updatedById], references: [id], onDelete: SetNull, onUpdate: NoAction)

  deletedAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@unique([method, path])
}

model Role {
  id          Int          @id @default(autoincrement())
  name        String       @unique @db.VarChar(500)
  description String
  isActive    Boolean      @default(true)
  permissions Permission[]
  users       User[]

  createdById Int?
  createdBy   User? @relation("RoleCreatedBy", fields: [createdById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  updatedById Int?
  updatedBy   User? @relation("RoleUpdatedBy", fields: [updatedById], references: [id], onDelete: SetNull, onUpdate: NoAction)

  deletedAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Category {
  id                   Int                   @id @default(autoincrement())
  name                 String
  description          String?
  parentCategoryId     Int?
  parentCategory       Category?             @relation("ParentCategoryCategories", fields: [parentCategoryId], references: [id], onDelete: SetNull, onUpdate: NoAction)
  childrenCategories   Category[]            @relation("ParentCategoryCategories")
  categoryTranslations CategoryTranslation[]
  courses              Course[]

  createdById Int?
  createdBy   User? @relation("CategoryCreatedBy", fields: [createdById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  updatedById Int?
  updatedBy   User? @relation("CategoryUpdatedBy", fields: [updatedById], references: [id], onDelete: SetNull, onUpdate: NoAction)

  deletedAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@index([createdAt])
  @@index([name])
  @@index([parentCategoryId])
}

model CategoryTranslation {
  id          Int      @id @default(autoincrement())
  categoryId  Int
  category    Category @relation(fields: [categoryId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  languageId  Int
  language    Language @relation(fields: [languageId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  name        String   @db.VarChar(500)
  description String

  createdById Int?
  createdBy   User? @relation("CategoryTranslationCreatedBy", fields: [createdById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  updatedById Int?
  updatedBy   User? @relation("CategoryTranslationUpdatedBy", fields: [updatedById], references: [id], onDelete: SetNull, onUpdate: NoAction)

  deletedAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Course {
  id                 Int               @id @default(autoincrement())
  title              String
  description        String?
  price              Decimal           @default(0) @db.Decimal(10, 2)
  category           Category?         @relation(fields: [categoryId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  categoryId         Int?
  teacher            Teacher?          @relation(fields: [teacherId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  teacherId          Int?
  rating             Float             @default(0)
  isFree             Boolean           @default(false)
  isFeatured         Boolean           @default(false)
  isPreorder         Boolean           @default(false)
  isDelete           Boolean           @default(false)
  thumbnail          String?
  videoUrl           String?
  status             CourseStatus      @default(Pending)
  hashtagCount       Int               @default(0)
  hasPreview         Boolean           @default(false)
  previewDescription String?
  createdAt          DateTime          @default(now())
  createdBy          User?             @relation("createCourseByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById        Int?
  updatedAt          DateTime          @updatedAt
  updatedBy          User?             @relation("updateCourseByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById        Int?
  deletedAt          DateTime?
  modules            Module[]
  enrollments        Enrollment[]
  wishlist           Wishlist[]
  comments           Comment[]
  reviews            Review[]
  certificates       Certificate[]
  orderItems         OrderItem[]
  learningPaths      LearningPath[]    @relation("LearningPathCourses")
  coupons            Coupon[]
  purchaseHistory    PurchaseHistory[]
  subscriptions      Subscription[]
  hashtags           Hashtag[]         @relation("CourseHashtags")
  blogs              Blog[]
  banners            Banner[]          @relation("CourseBanners")
  cart               Cart[]            @relation("CourseCart")
  feedback           Feedback[]        @relation("courseFeedback")
  qaThreads          QaThread[]

  @@index([createdAt])
  @@index([categoryId])
  @@index([teacherId])
  @@index([status])
  @@index([hasPreview])
}

model Module {
  id           Int       @id @default(autoincrement())
  course       Course    @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId     Int
  title        String
  description  String?
  chapterOrder Int
  isDelete     Boolean   @default(false)
  createdAt    DateTime  @default(now())
  createdBy    User?     @relation("createModuleByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById  Int?
  updatedAt    DateTime  @updatedAt
  updatedBy    User?     @relation("updateModuleByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById  Int?
  deletedAt    DateTime?
  lessons      Lesson[]
  quizzes      Quizz[]

  @@index([createdAt])
  @@index([chapterOrder])
}

model Lesson {
  id                Int                @id @default(autoincrement())
  module            Module             @relation(fields: [chapterId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  chapterId         Int
  title             String
  videoUrl          String?
  documentUrl       String?
  lessonOrder       Int
  isPreviewable     Boolean            @default(false)
  isDelete          Boolean            @default(false)
  createdAt         DateTime           @default(now())
  createdBy         User?              @relation("createLessonByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById       Int?
  updatedAt         DateTime           @updatedAt
  updatedBy         User?              @relation("updateLessonByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById       Int?
  deletedAt         DateTime?
  lessonBookmarks   LessonBookmark[]
  lessonCompletions LessonCompletion[]
  quizzes           Quizz[]
  qaThreads         QaThread[]

  @@unique([chapterId, title])
  @@index([createdAt])
  @@index([chapterId])
  @@index([isPreviewable])
}

model LessonCompletion {
  id          Int       @id @default(autoincrement())
  user        User      @relation("lessonCompleteByUser", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  lesson      Lesson    @relation(fields: [lessonId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  lessonId    Int
  completedAt DateTime
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createLessonCompleteByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateLessonCompleteByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([lessonId])
}

model Certificate {
  id          Int       @id @default(autoincrement())
  user        User      @relation("userCertificate", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  course      Course    @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId    Int
  issuedAt    DateTime?
  url         String?
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createCertificateByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateCertificateByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([courseId])
}

model Enrollment {
  id                   Int              @id @default(autoincrement())
  user                 User             @relation("userEnrollment", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId               Int
  course               Course           @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId             Int
  status               EnrollmentStatus @default(NotStarted)
  progress             Int              @default(0)
  completedLessonCount Int              @default(0)
  enrolledAt           DateTime?
  isDelete             Boolean          @default(false)
  createdAt            DateTime         @default(now())
  createdBy            User?            @relation("createEnrollmentByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById          Int?
  updatedAt            DateTime         @updatedAt
  updatedBy            User?            @relation("updateEnrollmentByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById          Int?
  deletedAt            DateTime?

  @@unique([userId, courseId])
  @@index([createdAt])
  @@index([userId])
  @@index([courseId])
  @@index([status])
}

model Blog {
  id            Int            @id @default(autoincrement())
  course        Course         @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId      Int
  title         String
  content       String         @db.Text
  thumbnail     String?
  status        BlogStatus     @default(Draft)
  hashtagCount  Int            @default(0)
  isDelete      Boolean        @default(false)
  createdAt     DateTime       @default(now())
  createdBy     User?          @relation("createBlogByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById   Int?
  updatedAt     DateTime       @updatedAt
  updatedBy     User?          @relation("updateBlogByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById   Int?
  deletedAt     DateTime?
  blogBookmarks BlogBookmark[]
  hashtags      Hashtag[]      @relation("BlogHashtags")
  topics        BlogTopic[]    @relation("BlogTopics")
  blogLikes     BlogLike[]
  blogComments  BlogComment[]

  @@index([createdAt])
  @@index([courseId])
  @@index([status])
}

model BlogTopic {
  id          Int         @id @default(autoincrement())
  name        String      @unique
  description String?
  parent      BlogTopic?  @relation("BlogTopicHierarchy", fields: [parentId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  parentId    Int?
  isDelete    Boolean     @default(false)
  createdAt   DateTime    @default(now())
  createdBy   User?       @relation("createBlogTopicByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime    @updatedAt
  updatedBy   User?       @relation("updateBlogTopicByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?
  children    BlogTopic[] @relation("BlogTopicHierarchy")
  blogs       Blog[]      @relation("BlogTopics")

  @@index([name])
  @@index([createdAt])
}

model BlogBookmark {
  id          Int       @id @default(autoincrement())
  user        User      @relation("userBlogBookmark", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  blog        Blog      @relation(fields: [blogId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  blogId      Int
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createBlogBookmarkByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateBlogBookmarkByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([blogId])
}

model LearningPath {
  id          Int                @id @default(autoincrement())
  user        User               @relation("userLearningPath", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  title       String
  description String?
  status      LearningPathStatus @default(Draft)
  isPublic    Boolean            @default(false)
  isDelete    Boolean            @default(false)
  createdAt   DateTime           @default(now())
  createdBy   User?              @relation("createLearningPathByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime           @updatedAt
  updatedBy   User?              @relation("updateLearningPathByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?
  courses     Course[]           @relation("LearningPathCourses")

  @@index([createdAt])
  @@index([userId])
  @@index([status])
}

model LessonBookmark {
  id          Int       @id @default(autoincrement())
  user        User      @relation("userLessonBookmark", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  lesson      Lesson    @relation(fields: [lessonId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  lessonId    Int
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createLessonBookmarkByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateLessonBookmarkByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([lessonId])
}

model Wishlist {
  id          Int       @id @default(autoincrement())
  user        User      @relation("userWishlist", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  course      Course    @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId    Int
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createWishlistByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateWishlistByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([courseId])
}

model Cart {
  id          Int       @id @default(autoincrement())
  user        User      @relation("userCart", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  course      Course    @relation("CourseCart", fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId    Int
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createCartByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateCartByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([courseId])
}

model Order {
  id                  Int                  @id @default(autoincrement())
  orderNumber         String               @unique
  user                User                 @relation("userOrder", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId              Int
  subtotalAmount      Decimal              @db.Decimal(10, 2)
  taxAmount           Decimal              @default(0) @db.Decimal(10, 2)
  feeAmount           Decimal              @default(0) @db.Decimal(10, 2)
  discountAmount      Decimal              @default(0) @db.Decimal(10, 2)
  totalAmount         Decimal              @db.Decimal(10, 2)
  currency            String               @default("VND")
  paymentMethod       String?
  paymentGateway      PaymentGateway?      @relation(fields: [paymentGatewayId], references: [id], onDelete: SetNull)
  paymentGatewayId    Int?
  paymentReference    String?
  status              OrderStatus          @default(Draft)
  orderType           OrderType            @default(Purchase)
  notes               String?
  customerNotes       String?
  adminNotes          String?
  orderedAt           DateTime?
  paidAt              DateTime?
  expiresAt           DateTime?
  cancelledAt         DateTime?
  refundedAt          DateTime?
  isDelete            Boolean              @default(false)
  createdAt           DateTime             @default(now())
  createdBy           User?                @relation("createOrderByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById         Int?
  updatedAt           DateTime             @updatedAt
  updatedBy           User?                @relation("updateOrderByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById         Int?
  deletedAt           DateTime?
  orderItems          OrderItem[]
  couponUsages        CouponUsage[]
  paymentTransactions PaymentTransaction[]
  purchaseHistory     PurchaseHistory[]
  subscriptions       Subscription[]
  webhookEvents       WebhookEvent[]
  refundRequests      RefundRequest[]

  @@index([orderNumber])
  @@index([userId, status])
  @@index([status, orderedAt])
  @@index([paymentGatewayId])
  @@index([expiresAt])
  @@index([createdAt])
  @@index([paidAt])
  @@index([orderType])
}

model OrderItem {
  id                  Int           @id @default(autoincrement())
  order               Order         @relation(fields: [orderId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  orderId             Int
  course              Course        @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId            Int
  originalPrice       Decimal       @db.Decimal(10, 2)
  discountedPrice     Decimal       @db.Decimal(10, 2)
  finalPrice          Decimal       @db.Decimal(10, 2)
  appliedDiscountId   Int?
  appliedDiscountType DiscountType?
  discountAmount      Decimal       @default(0) @db.Decimal(10, 2)
  discountPercentage  Decimal?      @db.Decimal(5, 2)
  status              ItemStatus    @default(Active)
  courseTitle         String
  courseDescription   String?
  courseThumbnail     String?
  isDelete            Boolean       @default(false)
  createdAt           DateTime      @default(now())
  createdBy           User?         @relation("createOrderItemByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById         Int?
  updatedAt           DateTime      @updatedAt
  updatedBy           User?         @relation("updateOrderItemByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById         Int?
  deletedAt           DateTime?

  @@index([orderId])
  @@index([courseId])
  @@index([appliedDiscountId])
  @@index([status])
  @@index([createdAt])
}

model PurchaseHistory {
  id              Int          @id @default(autoincrement())
  user            User         @relation("userPurchaseHistory", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId          Int
  order           Order        @relation(fields: [orderId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  orderId         Int
  orderNumber     String
  course          Course       @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId        Int
  courseTitle     String
  courseThumbnail String?
  categoryName    String?
  teacherName     String?
  originalPrice   Decimal      @db.Decimal(10, 2)
  finalPrice      Decimal      @db.Decimal(10, 2)
  discountAmount  Decimal      @default(0) @db.Decimal(10, 2)
  currency        String       @default("VND")
  orderStatus     OrderStatus
  paymentMethod   String?
  orderedAt       DateTime
  paidAt          DateTime?
  accessGrantedAt DateTime?
  accessExpiresAt DateTime?
  accessStatus    AccessStatus @default(Pending)
  isRefunded      Boolean      @default(false)
  isActive        Boolean      @default(true)
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt

  @@index([userId, orderedAt])
  @@index([userId, orderStatus])
  @@index([courseId])
  @@index([orderedAt])
  @@index([accessStatus])
  @@index([isActive])
}

model Subscription {
  id              Int                @id @default(autoincrement())
  user            User               @relation("userSubscription", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId          Int
  course          Course             @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId        Int
  order           Order?             @relation(fields: [orderId], references: [id], onDelete: SetNull)
  orderId         Int?
  planType        PlanType
  status          SubscriptionStatus @default(Active)
  basePrice       Decimal            @db.Decimal(10, 2)
  currentPrice    Decimal            @db.Decimal(10, 2)
  currency        String             @default("VND")
  billingCycle    Int
  nextBillingDate DateTime?
  lastBillingDate DateTime?
  startedAt       DateTime
  expiresAt       DateTime?
  cancelledAt     DateTime?
  pausedAt        DateTime?
  isDelete        Boolean            @default(false)
  createdAt       DateTime           @default(now())
  updatedAt       DateTime           @updatedAt

  @@index([userId, status])
  @@index([courseId])
  @@index([nextBillingDate])
  @@index([status])
}

model PurchaseAnalytics {
  id                Int         @id @default(autoincrement())
  user              User        @relation("userPurchaseAnalytics", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId            Int         @unique
  totalOrders       Int         @default(0)
  totalSpent        Decimal     @default(0) @db.Decimal(12, 2)
  totalCoursesOwned Int         @default(0)
  totalRefunds      Int         @default(0)
  totalRefundAmount Decimal     @default(0) @db.Decimal(12, 2)
  averageOrderValue Decimal     @default(0) @db.Decimal(10, 2)
  firstPurchaseDate DateTime?
  lastPurchaseDate  DateTime?
  favoriteCategory  String?
  loyaltyPoints     Int         @default(0)
  loyaltyTier       LoyaltyTier @default(Bronze)
  calculatedAt      DateTime?
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt

  @@index([userId])
  @@index([loyaltyTier])
  @@index([totalSpent])
}

model PaymentGateway {
  id                  Int                  @id @default(autoincrement())
  name                String               @unique
  displayName         String
  isActive            Boolean              @default(true)
  config              Json?
  supportedCurrencies String?
  webhookUrl          String?
  webhookSecret       String?
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  orders              Order[]
  paymentTransactions PaymentTransaction[]
  userPaymentMethods  UserPaymentMethod[]
  paymentFees         PaymentFee[]
  webhookEvents       WebhookEvent[]

  @@index([name])
  @@index([isActive])
}

model PaymentTransaction {
  id                   Int               @id @default(autoincrement())
  order                Order             @relation(fields: [orderId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  orderId              Int
  paymentGateway       PaymentGateway    @relation(fields: [paymentGatewayId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  paymentGatewayId     Int
  gatewayTransactionId String?
  gatewayOrderId       String?
  transactionType      TransactionType
  amount               Decimal           @db.Decimal(10, 2)
  currency             String            @default("VND")
  status               TransactionStatus @default(Pending)
  gatewayStatus        String?
  gatewayResponse      Json?
  failureReason        String?
  processedAt          DateTime?
  notifiedAt           DateTime?
  isDelete             Boolean           @default(false)
  createdAt            DateTime          @default(now())
  updatedAt            DateTime          @updatedAt
  webhookEvents        WebhookEvent[]
  refundRequests       RefundRequest[]

  @@index([orderId])
  @@index([paymentGatewayId])
  @@index([gatewayTransactionId])
  @@index([status])
  @@index([transactionType])
  @@index([createdAt])
}

model Comment {
  id          Int       @id @default(autoincrement())
  user        User      @relation("userComment", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  course      Course    @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId    Int
  content     String
  isPositive  Boolean   @default(true)
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createCommentByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateCommentByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([courseId])
}

model UserPaymentMethod {
  id                Int            @id @default(autoincrement())
  user              User           @relation("userUserPaymentMethod", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId            Int
  paymentGateway    PaymentGateway @relation(fields: [paymentGatewayId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  paymentGatewayId  Int
  methodType        MethodType
  isDefault         Boolean        @default(false)
  lastFourDigits    String?
  expiryMonth       Int?
  expiryYear        Int?
  cardBrand         String?
  gatewayMethodId   String?
  gatewayCustomerId String?
  metadata          Json?
  isActive          Boolean        @default(true)
  isDelete          Boolean        @default(false)
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt

  @@index([userId])
  @@index([paymentGatewayId])
  @@index([isDefault])
  @@index([isActive])
}

model PaymentFee {
  id               Int            @id @default(autoincrement())
  paymentGateway   PaymentGateway @relation(fields: [paymentGatewayId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  paymentGatewayId Int
  feeType          FeeType
  minAmount        Decimal?       @db.Decimal(10, 2)
  maxAmount        Decimal?       @db.Decimal(10, 2)
  fixedFee         Decimal        @default(0) @db.Decimal(10, 2)
  percentageFee    Decimal        @default(0) @db.Decimal(5, 4)
  currency         String         @default("VND")
  isActive         Boolean        @default(true)
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt

  @@index([paymentGatewayId])
  @@index([isActive])
}

model RefundRequest {
  id              Int                @id @default(autoincrement())
  order           Order              @relation(fields: [orderId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  orderId         Int
  transaction     PaymentTransaction @relation(fields: [transactionId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  transactionId   Int
  requestedAmount Decimal            @db.Decimal(10, 2)
  refundedAmount  Decimal            @default(0) @db.Decimal(10, 2)
  reason          String
  status          RefundStatus       @default(Pending)
  requestedBy     User               @relation("RequestedBy", fields: [requestedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  requestedById   Int
  approvedBy      User?              @relation("ApprovedBy", fields: [approvedById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  approvedById    Int?
  gatewayRefundId String?
  adminNotes      String?
  processedAt     DateTime?
  isDelete        Boolean            @default(false)
  createdAt       DateTime           @default(now())
  updatedAt       DateTime           @updatedAt

  @@index([orderId])
  @@index([transactionId])
  @@index([status])
  @@index([requestedById])
  @@index([createdAt])
}

model WebhookEvent {
  id               Int                 @id @default(autoincrement())
  paymentGateway   PaymentGateway      @relation(fields: [paymentGatewayId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  paymentGatewayId Int
  eventType        String
  eventId          String?
  order            Order?              @relation(fields: [orderId], references: [id], onDelete: SetNull, onUpdate: NoAction)
  orderId          Int?
  transaction      PaymentTransaction? @relation(fields: [transactionId], references: [id], onDelete: SetNull, onUpdate: NoAction)
  transactionId    Int?
  payload          Json
  signature        String?
  status           WebhookStatus       @default(Pending)
  processedAt      DateTime?
  errorMessage     String?
  retryCount       Int                 @default(0)
  createdAt        DateTime            @default(now())
  updatedAt        DateTime            @updatedAt

  @@index([paymentGatewayId])
  @@index([eventType])
  @@index([orderId])
  @@index([transactionId])
  @@index([status])
  @@index([createdAt])
}

model Review {
  id          Int       @id @default(autoincrement())
  user        User      @relation("userReview", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  course      Course    @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId    Int
  rating      Int
  content     String?
  isPositive  Boolean   @default(true)
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createReviewByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateReviewByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([courseId])
}

model Follower {
  id          Int       @id @default(autoincrement())
  user        User      @relation("userFollower", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  teacher     Teacher   @relation(fields: [teacherId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  teacherId   Int
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createFollowerByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateFollowerByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@unique([userId, teacherId])
  @@index([createdAt])
  @@index([userId])
  @@index([teacherId])
}

model Teacher {
  id             Int        @id @default(autoincrement())
  user           User       @relation("userTeacher", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId         Int        @unique
  bio            String?
  specialization String?
  experience     String?
  followersCount Int        @default(0)
  isDelete       Boolean    @default(false)
  createdAt      DateTime   @default(now())
  createdBy      User?      @relation("createTeacherByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById    Int?
  updatedAt      DateTime   @updatedAt
  updatedBy      User?      @relation("updateTeacherByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById    Int?
  deletedAt      DateTime?
  courses        Course[]
  followers      Follower[]

  @@index([createdAt])
}

model Coupon {
  id             Int                @id @default(autoincrement())
  code           String             @unique @db.VarChar(50)
  course         Course?            @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId       Int?
  discountType   CouponDiscountType
  discountAmount Float
  maxUses        Int?
  perUserLimit   Int?
  expirationDate DateTime
  isDelete       Boolean            @default(false)
  createdAt      DateTime           @default(now())
  createdBy      User?              @relation("createCouponByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById    Int?
  updatedAt      DateTime           @updatedAt
  updatedBy      User?              @relation("updateCouponByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById    Int?
  deletedAt      DateTime?
  couponUsages   CouponUsage[]

  @@index([createdAt])
  @@index([courseId])
  @@index([expirationDate])
}

model CouponUsage {
  id          Int       @id @default(autoincrement())
  coupon      Coupon    @relation(fields: [couponId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  couponId    Int
  user        User      @relation("userCouponUsage", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  order       Order     @relation(fields: [orderId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  orderId     Int
  usedAt      DateTime
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createCouponUsageByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateCouponUsageByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([couponId])
  @@index([userId])
  @@index([orderId])
}

model SystemDiscount {
  id             Int                @id @default(autoincrement())
  title          String
  discountType   SystemDiscountType
  discountAmount Decimal            @db.Decimal(10, 2)
  startDate      DateTime
  endDate        DateTime
  isActive       Boolean            @default(true)
  isDelete       Boolean            @default(false)
  createdAt      DateTime           @default(now())
  createdBy      User?              @relation("createSystemDiscountByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById    Int?
  updatedAt      DateTime           @updatedAt
  updatedBy      User?              @relation("updateSystemDiscountByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById    Int?
  deletedAt      DateTime?
  banners        Banner[]           @relation("DiscountBanners")

  @@index([createdAt])
  @@index([startDate])
  @@index([endDate])
  @@index([isActive])
}

model Hashtag {
  id             Int       @id @default(autoincrement())
  name           String
  normalizedName String    @unique
  isDelete       Boolean   @default(false)
  createdAt      DateTime  @default(now())
  createdBy      User?     @relation("createHashtagByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById    Int?
  updatedAt      DateTime  @updatedAt
  updatedBy      User?     @relation("updateHashtagByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById    Int?
  deletedAt      DateTime?
  courses        Course[]  @relation("CourseHashtags")
  blogs          Blog[]    @relation("BlogHashtags")

  @@index([createdAt])
  @@index([name])
  @@index([normalizedName])
}

model BlogLike {
  id          Int       @id @default(autoincrement())
  user        User      @relation("userBlogLike", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId      Int
  blog        Blog      @relation(fields: [blogId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  blogId      Int
  isDelete    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  createdBy   User?     @relation("createBlogLikeByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById Int?
  updatedAt   DateTime  @updatedAt
  updatedBy   User?     @relation("updateBlogLikeByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById Int?
  deletedAt   DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([blogId])
}

model BlogComment {
  id               Int               @id @default(autoincrement())
  user             User              @relation("userBlogComment", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId           Int
  blog             Blog              @relation(fields: [blogId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  blogId           Int
  parent           BlogComment?      @relation("BlogCommentHierarchy", fields: [parentId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  parentId         Int?
  content          String
  isDelete         Boolean           @default(false)
  createdAt        DateTime          @default(now())
  createdBy        User?             @relation("createBlogCommentByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById      Int?
  updatedAt        DateTime          @updatedAt
  updatedBy        User?             @relation("updateBlogCommentByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById      Int?
  deletedAt        DateTime?
  children         BlogComment[]     @relation("BlogCommentHierarchy")
  commentReactions CommentReaction[]

  @@index([createdAt])
  @@index([userId])
  @@index([blogId])
  @@index([parentId])
}

model CommentReaction {
  id           Int          @id @default(autoincrement())
  user         User         @relation("userCommentReaction", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId       Int
  comment      BlogComment  @relation(fields: [commentId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  commentId    Int
  reactionType ReactionType
  isDelete     Boolean      @default(false)
  createdAt    DateTime     @default(now())
  createdBy    User?        @relation("createCommentReactionByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById  Int?
  updatedAt    DateTime     @updatedAt
  updatedBy    User?        @relation("updateCommentReactionByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById  Int?
  deletedAt    DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([commentId])
}

model Quizz {
  id            Int            @id @default(autoincrement())
  lesson        Lesson?        @relation(fields: [lessonId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  lessonId      Int?
  module        Module?        @relation(fields: [moduleId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  moduleId      Int?
  title         String
  description   String?
  status        QuizStatus     @default(Draft)
  isDelete      Boolean        @default(false)
  createdAt     DateTime       @default(now())
  createdBy     User?          @relation("createQuizzByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById   Int?
  updatedAt     DateTime       @updatedAt
  updatedBy     User?          @relation("updateQuizzByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById   Int?
  deletedAt     DateTime?
  quizQuestions QuizQuestion[]
  quizAttempts  QuizAttempt[]

  @@index([createdAt])
  @@index([lessonId])
  @@index([moduleId])
  @@index([status])
}

model QuizQuestion {
  id                Int                @id @default(autoincrement())
  quiz              Quizz              @relation(fields: [quizId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  quizId            Int
  content           String
  explanation       String
  questionOrder     Int
  isDelete          Boolean            @default(false)
  createdAt         DateTime           @default(now())
  createdBy         User?              @relation("createQuizQuestionByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById       Int?
  updatedAt         DateTime           @updatedAt
  updatedBy         User?              @relation("updateQuizQuestionByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById       Int?
  deletedAt         DateTime?
  quizAnswerOptions QuizAnswerOption[]
  quizUserAnswers   QuizUserAnswer[]

  @@index([createdAt])
  @@index([quizId])
}

model QuizAnswerOption {
  id              Int              @id @default(autoincrement())
  question        QuizQuestion     @relation(fields: [questionId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  questionId      Int
  content         String
  isCorrect       Boolean          @default(false)
  optionOrder     Int
  isDelete        Boolean          @default(false)
  createdAt       DateTime         @default(now())
  createdBy       User?            @relation("createQuizAnswerOptionByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById     Int?
  updatedAt       DateTime         @updatedAt
  updatedBy       User?            @relation("updateQuizAnswerOptionByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById     Int?
  deletedAt       DateTime?
  quizUserAnswers QuizUserAnswer[]

  @@index([createdAt])
  @@index([questionId])
}

model QuizAttempt {
  id              Int              @id @default(autoincrement())
  user            User             @relation("userQuizAttempt", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId          Int
  quiz            Quizz            @relation(fields: [quizId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  quizId          Int
  score           Decimal          @default(0) @db.Decimal(5, 2)
  completedAt     DateTime?
  isDelete        Boolean          @default(false)
  createdAt       DateTime         @default(now())
  createdBy       User?            @relation("createQuizAttemptByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById     Int?
  updatedAt       DateTime         @updatedAt
  updatedBy       User?            @relation("updateQuizAttemptByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById     Int?
  deletedAt       DateTime?
  quizUserAnswers QuizUserAnswer[]

  @@index([createdAt])
  @@index([userId])
  @@index([quizId])
}

model QuizUserAnswer {
  id             Int              @id @default(autoincrement())
  attempt        QuizAttempt      @relation(fields: [attemptId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  attemptId      Int
  question       QuizQuestion     @relation(fields: [questionId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  questionId     Int
  answerOption   QuizAnswerOption @relation(fields: [answerOptionId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  answerOptionId Int
  isDelete       Boolean          @default(false)
  createdAt      DateTime         @default(now())
  createdBy      User?            @relation("createQuizUserAnswerByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById    Int?
  updatedAt      DateTime         @updatedAt
  updatedBy      User?            @relation("updateQuizUserAnswerByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById    Int?
  deletedAt      DateTime?

  @@index([createdAt])
  @@index([attemptId])
  @@index([questionId])
  @@index([answerOptionId])
}

model Feedback {
  id           Int            @id @default(autoincrement())
  user         User           @relation("userFeedback", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId       Int
  course       Course?        @relation("courseFeedback", fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId     Int?
  title        String
  content      String
  feedbackType FeedbackType
  status       FeedbackStatus @default(Pending)
  isDelete     Boolean        @default(false)
  createdAt    DateTime       @default(now())
  createdBy    User?          @relation("createFeedbackByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById  Int?
  updatedAt    DateTime       @updatedAt
  updatedBy    User?          @relation("updateFeedbackByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById  Int?
  deletedAt    DateTime?

  @@index([createdAt])
  @@index([userId])
  @@index([courseId])
  @@index([status])
}

model Banner {
  id             Int             @id @default(autoincrement())
  title          String
  imageUrl       String
  targetType     TargetType
  course         Course?         @relation("CourseBanners", fields: [targetId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "banner_course_constraint")
  systemDiscount SystemDiscount? @relation("DiscountBanners", fields: [targetId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "banner_system_discount_constraint")
  targetId       Int?
  targetUrl      String?
  priority       Int             @default(0)
  startDate      DateTime
  endDate        DateTime?
  status         BannerStatus    @default(Draft)
  clickCount     Int             @default(0)
  isDelete       Boolean         @default(false)
  createdAt      DateTime
  createdBy      User?           @relation("createBannerByUser", fields: [createdById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  createdById    Int?
  updatedAt      DateTime        @updatedAt
  updatedBy      User?           @relation("updateBannerByUser", fields: [updatedById], references: [id], onDelete: Cascade, onUpdate: NoAction)
  updatedById    Int?
  deletedAt      DateTime?

  @@index([createdAt])
  @@index([targetId])
  @@index([startDate])
  @@index([priority])
  @@index([endDate])
  @@index([status])
}

model Conversation {
  id           Int                       @id @default(autoincrement())
  type         ConversationType
  title        String?
  description  String?
  isActive     Boolean                   @default(true)
  createdAt    DateTime                  @default(now())
  createdBy    User?                     @relation("createConversationByUser", fields: [createdById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  createdById  Int?
  updatedAt    DateTime                  @updatedAt
  updatedBy    User?                     @relation("updateConversationByUser", fields: [updatedById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  updatedById  Int?
  participants ConversationParticipant[]
  messages     Message[]
  joinRequests ConversationJoinRequest[]

  @@index([type])
  @@index([isActive])
  @@index([createdAt])
}

model ConversationParticipant {
  id             Int             @id @default(autoincrement())
  conversation   Conversation    @relation(fields: [conversationId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  conversationId Int
  user           User            @relation("userConversationParticipant", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId         Int
  role           ParticipantRole @default(MEMBER)
  joinedAt       DateTime        @default(now())
  updatedAt      DateTime        @default(now()) @updatedAt
  lastReadAt     DateTime?
  isActive       Boolean         @default(true)
  leftAt         DateTime?
  hiddenAt       DateTime?

  @@unique([conversationId, userId])
  @@index([conversationId])
  @@index([userId])
  @@index([isActive])
}

model ConversationJoinRequest {
  id             Int               @id @default(autoincrement())
  conversationId Int
  requesterId    Int
  invitedUserId  Int
  status         JoinRequestStatus @default(PENDING)
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt

  conversation Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)
  requester    User         @relation("JoinRequestRequester", fields: [requesterId], references: [id], onDelete: Cascade)
  invitedUser  User         @relation("JoinRequestInvitedUser", fields: [invitedUserId], references: [id], onDelete: Cascade)

  @@index([conversationId])
  @@index([invitedUserId])
  @@index([status])
}

model Message {
  id               Int               @id @default(autoincrement())
  conversation     Conversation      @relation(fields: [conversationId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  conversationId   Int
  sender           User?             @relation("senderMessage", fields: [senderId], references: [id], onDelete: SetNull, onUpdate: NoAction)
  senderId         Int?
  content          String
  messageType      MessageType       @default(TEXT)
  attachments      Json?
  replyToMessage   Message?          @relation("MessageReplies", fields: [replyToMessageId], references: [id], onDelete: SetNull, onUpdate: NoAction)
  replyToMessageId Int?
  isEdited         Boolean           @default(false)
  editedAt         DateTime?
  isDeleted        Boolean           @default(false)
  deletedAt        DateTime?
  deletedBy        User?             @relation("deleteMessagenByUser", fields: [deletedById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  deletedById      Int?
  sentAt           DateTime          @default(now())
  messageReads     MessageRead[]
  messageReactions MessageReaction[]
  replies          Message[]         @relation("MessageReplies")
  MessagePin       MessagePin[]

  @@index([conversationId, sentAt], name: "message_conversation_time_index")
  @@index([senderId], name: "message_sender_index")
  @@index([replyToMessageId], name: "message_reply_index")
  @@index([isDeleted], name: "message_deleted_index")
  @@index([messageType], name: "message_type_index")
}

model MessageRead {
  id        Int      @id @default(autoincrement())
  message   Message  @relation(fields: [messageId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  messageId Int
  user      User     @relation("messageReadByUser", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId    Int
  readAt    DateTime @default(now())

  @@unique([messageId, userId])
  @@index([userId, readAt])
}

model MessageReaction {
  id        Int      @id @default(autoincrement())
  message   Message  @relation(fields: [messageId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  messageId Int
  user      User     @relation("messageReactionByUser", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId    Int
  emoji     String
  createdAt DateTime @default(now())

  @@unique([messageId, userId, emoji])
  @@index([messageId])
}

model MessagePin {
  messageId  Int      @id
  message    Message  @relation(fields: [messageId], references: [id], onDelete: Cascade)
  pinnedById Int?
  pinnedBy   User?    @relation(fields: [pinnedById], references: [id])
  pinnedAt   DateTime @default(now())
}

model Notification {
  id                Int              @id @default(autoincrement())
  user              User             @relation("userNotification", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId            Int
  type              NotificationType
  title             String
  content           String?
  relatedEntityType String?
  relatedEntityId   Int?
  isRead            Boolean          @default(false)
  readAt            DateTime?
  createdAt         DateTime         @default(now())

  @@index([userId, isRead])
  @@index([userId, createdAt])
  @@index([type])
}

model FileUpload {
  id           Int      @id @default(autoincrement())
  fileName     String
  originalName String
  mimeType     String
  fileSize     Int
  filePath     String
  uploadedBy   User?    @relation("userUploadFile", fields: [uploadedById], references: [id], onDelete: SetNull, onUpdate: NoAction)
  uploadedById Int?
  isPublic     Boolean  @default(false)
  createdAt    DateTime @default(now())

  @@index([uploadedById], name: "file_uploader_index")
  @@index([mimeType], name: "file_type_index")
  @@index([createdAt], name: "file_created_index")
}

/// ===== Q&A Module =====
model QaThread {
  id Int @id @default(autoincrement())

  lesson       Lesson @relation(fields: [lessonId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  lessonId     Int
  course       Course @relation(fields: [courseId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  courseId     Int
  instructor   User   @relation("QaThreadInstructor", fields: [instructorId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  instructorId Int

  author   User @relation("QaThreadAuthor", fields: [authorId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  authorId Int

  title   String?
  content String

  status     QaStatus @default(PENDING)
  isResolved Boolean  @default(false)

  // Accepted answer (có relation name riêng)
  acceptedPostId Int?    @unique
  acceptedPost   QaPost? @relation("QaThreadAcceptedAnswer", fields: [acceptedPostId], references: [id], onDelete: SetNull)

  locked         Boolean   @default(false)
  lastActivityAt DateTime?

  // List of posts in the thread (give the relation a separate name)
  posts QaPost[] @relation("QaThreadPosts")

  // per-user read tracking
  reads QaThreadRead[]

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  isDelete  Boolean   @default(false)
  deletedAt DateTime?

  @@index([lessonId])
  @@index([courseId])
  @@index([instructorId])
  @@index([authorId])
  @@index([status, isResolved])
  @@index([createdAt])
  @@index([lastActivityAt])
  @@index([instructorId, status, isResolved, lastActivityAt])
  @@index([courseId, lessonId, lastActivityAt])
}

model QaPost {
  id Int @id @default(autoincrement())

  // Attach to the thread using the relation name "QaThreadPosts"
  thread   QaThread @relation("QaThreadPosts", fields: [threadId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  threadId Int

  author   User @relation("QaPostAuthor", fields: [authorId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  authorId Int

  content String

  // Reply by thread
  parentId Int?
  parent   QaPost?  @relation("QaPostHierarchy", fields: [parentId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  children QaPost[] @relation("QaPostHierarchy")

  // Back-relation for accepted answer (corresponding to QaThread.acceptedPost)
  acceptedForThread QaThread? @relation("QaThreadAcceptedAnswer")

  reactions QaReaction[]

  isEdited  Boolean   @default(false)
  editedAt  DateTime?
  isDelete  Boolean   @default(false)
  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([threadId])
  @@index([authorId])
  @@index([parentId])
  @@index([createdAt])
}

model QaReaction {
  id Int @id @default(autoincrement())

  post   QaPost @relation(fields: [postId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  postId Int

  user   User @relation("QaReactionByUser", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  userId Int

  reaction  ReactionType
  createdAt DateTime     @default(now())

  @@unique([postId, userId, reaction])
  @@index([postId])
  @@index([userId])
  @@index([postId, createdAt])
}

model QaThreadRead {
  id         Int      @id @default(autoincrement())
  thread     QaThread @relation(fields: [threadId], references: [id], onDelete: Cascade)
  threadId   Int
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId     Int
  lastReadAt DateTime @default(now())

  @@unique([threadId, userId])
  @@index([userId, lastReadAt])
}

enum QaStatus {
  PENDING
  UNREAD
  RESOLVED
}

enum QaThreadStatus {
  Open
  PendingReply
  Resolved
  Closed
}

enum VerificationCodeType {
  REGISTER
  FORGOT_PASSWORD
  RESET_PASSWORD
}

enum UserStatus {
  ACTIVE
  INACTIVE
  BLOCKED
  SUSPENDED
}

enum HTTPMethod {
  GET
  POST
  PUT
  DELETE
  PATCH
  OPTIONS
  HEAD
}

enum SystemDiscountType {
  Percentage
  Fixed
}

enum ViolationType {
  Content
  Behavior
  Payment
  Other
}

enum ActionTaken {
  Warning
  Lock
  Suspend
  Unlock
}

enum CourseStatus {
  Pending
  Approved
  Blacklisted
}

enum LearningPathStatus {
  Draft
  Active
  Archived
}

enum EnrollmentStatus {
  NotStarted
  InProgress
  Completed
}

enum BlogStatus {
  Draft
  Published
  Archived
}

enum OrderStatus {
  Draft
  Pending
  Processing
  Paid
  Failed
  Cancelled
  Refunded
  PartialRefund
  Expired
}

enum OrderType {
  Purchase
  Subscription
  Renewal
  Upgrade
}

enum DiscountType {
  System
  Coupon
  Bulk
  Loyalty
}

enum ItemStatus {
  Active
  Cancelled
  Refunded
  Expired
}

enum AccessStatus {
  Pending
  Active
  Expired
  Revoked
}

enum PlanType {
  Monthly
  Quarterly
  Yearly
  Lifetime
}

enum SubscriptionStatus {
  Active
  Cancelled
  Expired
  Paused
  PendingCancellation
}

enum LoyaltyTier {
  Bronze
  Silver
  Gold
  Platinum
}

enum TransactionType {
  Payment
  Refund
  Chargeback
  Partial_Refund
}

enum TransactionStatus {
  Pending
  Processing
  Success
  Failed
  Cancelled
  Expired
}

enum MethodType {
  Card
  Wallet
  Bank
  Other
}

enum FeeType {
  Fixed
  Percentage
  Tiered
}

enum RefundStatus {
  Pending
  Approved
  Processing
  Completed
  Rejected
  Failed
}

enum WebhookStatus {
  Pending
  Processing
  Processed
  Failed
  Ignored
}

enum CouponDiscountType {
  Percentage
  Fixed
}

enum ReactionType {
  Like
  Love
  Haha
  Wow
  Sad
  Angry
}

enum QuizStatus {
  Draft
  Published
  Archived
}

enum FeedbackType {
  Bug
  FeatureRequest
  CourseContent
  General
}

enum FeedbackStatus {
  Pending
  Reviewed
  Resolved
  Closed
}

enum TargetType {
  Course
  Discount
  External
  Internal
}

enum BannerStatus {
  Draft
  Active
  Archived
}

enum ConversationType {
  DIRECT
  GROUP
  SUPPORT
}

enum ParticipantRole {
  ADMIN
  MODERATOR
  MEMBER
}

enum MessageType {
  TEXT
  IMAGE
  FILE
  VIDEO
  AUDIO
  SYSTEM
}

enum NotificationType {
  NEW_MESSAGE
  MENTION
  REACTION
}

enum JoinRequestStatus {
  PENDING
  APPROVED
  REJECTED
}
